function mpc = worui
%CASE30    Power flow data for 30 bus, 6 generator case.
%   Please see CASEFORMAT for details on the case file format.
%
%   Based on data from ...
%     Alsac, O. & Stott, B., "Optimal Load Flow with Steady State Security",
%     IEEE Transactions on Power Apparatus and Systems, Vol. PAS 93, No. 3,
%     1974, pp. 745-751.
%   ... with branch parameters rounded to nearest 0.01, shunt values divided
%   by 100 and shunt on bus 10 moved to bus 5, load at bus 5 zeroed out.
%   Generator locations, costs and limits and bus areas were taken from ...
%     Ferrero, R.W., Shahidehpour, S.M., Ramesh, V.C., "Transaction analysis
%     in deregulated power systems using game theory", IEEE Transactions on
%     Power Systems, Vol. 12, No. 3, Aug 1997, pp. 1340-1347.
%   Generator Q limits were derived from Alsac & Stott, using their Pmax
%   capacities. V limits and line |S| limits taken from Alsac & Stott.

%   MATPOWER

%% MATPOWER Case Format : Version 2
mpc.version = '2';

%%-----  Power Flow Data  -----%%
%% system MVA base
mpc.baseMVA = 100;

%% bus data
%	bus_i	type	Pd	Qd	Gs	Bs	area	Vm	Va	baseKV	zone	Vmax	Vmin
mpc.bus = [
	1	1	97.6	44.2	0	0	2	1.0393836	-13.536602	345	1	1.06	0.94;
	2	1	0	0	0	0	2	1.0484941	-9.7852666	345	1	1.06	0.94;
	3	1	322	2.4	0	0	2	1.0307077	-12.276384	345	1	1.06	0.94;
	4	1	500	184	0	0	1	1.00446	-12.626734	345	1	1.06	0.94;
	5	1	0	0	0	0	1	1.0060063	-11.192339	345	1	1.06	0.94;
	6	1	0	0	0	0	1	1.0082256	-10.40833	345	1	1.06	0.94;
	7	1	233.8	84	0	0	1	0.99839728	-12.755626	345	1	1.06	0.94;
	8	1	522	176.6	0	0	1	0.99787232	-13.335844	345	1	1.06	0.94;
	9	1	6.5	-66.6	0	0	1	1.038332	-14.178442	345	1	1.06	0.94;
	10	1	0	0	0	0	1	1.0178431	-8.170875	345	1	1.06	0.94;
	11	1	0	0	0	0	1	1.0133858	-8.9369663	345	1	1.06	0.94;
	12	1	8.53	88	0	0	1	1.000815	-8.9988236	345	1	1.06	0.94;
	13	1	0	0	0	0	1	1.014923	-8.9299272	345	1	1.06	0.94;
	14	1	0	0	0	0	1	1.012319	-10.715295	345	1	1.06	0.94;
	15	1	320	153	0	0	3	1.0161854	-11.345399	345	1	1.06	0.94;
	16	1	329	32.3	0	0	3	1.0325203	-10.033348	345	1	1.06	0.94;
	17	1	0	0	0	0	2	1.0342365	-11.116436	345	1	1.06	0.94;
	18	1	158	30	0	0	2	1.0315726	-11.986168	345	1	1.06	0.94;
	19	1	0	0	0	0	3	1.0501068	-5.4100729	345	1	1.06	0.94;
	20	1	680	103	0	0	3	0.99101054	-6.8211783	345	1	1.06	0.94;
	21	1	274	115	0	0	3	1.0323192	-7.6287461	345	1	1.06	0.94;
	22	1	0	0	0	0	3	1.0501427	-3.1831199	345	1	1.06	0.94;
	23	1	247.5	84.6	0	0	3	1.0451451	-3.3812763	345	1	1.06	0.94;
	24	1	308.6	-92.2	0	0	3	1.038001	-9.9137585	345	1	1.06	0.94;
	25	1	224	47.2	0	0	2	1.0576827	-8.3692354	345	1	1.06	0.94;
	26	1	139	17	0	0	2	1.0525613	-9.4387696	345	1	1.06	0.94;
	27	1	281	75.5	0	0	2	1.0383449	-11.362152	345	1	1.06	0.94;
	28	1	206	27.6	0	0	3	1.0503737	-5.9283592	345	1	1.06	0.94;
	29	1	283.5	26.9	0	0	3	1.0501149	-3.1698741	345	1	1.06	0.94;
	30	2	0	0	0	0	2	1.0499	-7.3704746	345	1	1.06	0.94;
	31	3	9.2	4.6	0	0	1	0.982	0	345	1	1.06	0.94;
	32	2	0	0	0	0	1	0.9841	-0.1884374	345	1	1.06	0.94;
	33	2	0	0	0	0	3	0.9972	-0.19317445	345	1	1.06	0.94;
	34	2	0	0	0	0	3	1.0123	-1.631119	345	1	1.06	0.94;
	35	2	0	0	0	0	3	1.0494	1.7765069	345	1	1.06	0.94;
	36	2	0	0	0	0	3	1.0636	4.4684374	345	1	1.06	0.94;
	37	2	0	0	0	0	2	1.0275	-1.5828988	345	1	1.06	0.94;
	38	2	0	0	0	0	3	1.0265	3.8928177	345	1	1.06	0.94;
	39	2	1104	250	0	0	1	1.03	-14.535256	345	1	1.06	0.94;
];

%% generator data
%	bus	Pg	Qg	Qmax	Qmin	Vg    mBase	status	Pmax	Pmin minup mindown  initup initdown	rampup	rampdown	type
mpc.gen = [
	30	78	0	300     -300	0.998	100     1	1040    100      5       3       5       0       500	500         2;
    31	0	0	50      -13     0.99	100     1	646     50       4       2       0       2       300	300         1;
    32	38	0	300     -300	1.015	100     1	725     70       3       2       3       0       350 350         1;
    33	38	0	200     -147	1.05	100     1	652     60       3       2       0       2       300	300         2;
    34	0	0	120     -35     0.99	100     1	508     50       4       2       4       0       250	250         1;
    35	25	0	30      -10     0.97	100     1	687     60       3       2       0       2       300	300         1;
    36	0	0	50      -16     0.973	100     1	580     50       1       1       1       0       300	300         1;
    37	0	0	24      -8      0.96522	100     1	564     50       1       2       1       0       250	250         2;
    38	0	0	24      -8      0.96522	100     1	865     80       1       2       1       0       400	400         1;
    39	0	0	24      -8      0.96522	100     1	1100    110      1       2       1       0       550	550         1;
];
%33 37改成天然气供气
%% branch data
%	fbus	tbus	r	x	b	rateA	rateB	rateC	ratio	angle	status	angmin	angmax
mpc.branch = [
	1	2	0.0035	0.0411	0.6987	600	600	600	0	0	1	-360	360;
	1	39	0.001	0.025	0.75	1000	1000	1000	0	0	1	-360	360;
	2	3	0.0013	0.0151	0.2572	500	500	500	0	0	1	-360	360;
	2	25	0.007	0.0086	0.146	500	500	500	0	0	1	-360	360;
	2	30	0	0.0181	0	900	900	2500	1.025	0	1	-360	360;
	3	4	0.0013	0.0213	0.2214	500	500	500	0	0	1	-360	360;
	3	18	0.0011	0.0133	0.2138	500	500	500	0	0	1	-360	360;
	4	5	0.0008	0.0128	0.1342	600	600	600	0	0	1	-360	360;
	4	14	0.0008	0.0129	0.1382	500	500	500	0	0	1	-360	360;
	5	6	0.0002	0.0026	0.0434	1200	1200	1200	0	0	1	-360	360;
	5	8	0.0008	0.0112	0.1476	900	900	900	0	0	1	-360	360;
	6	7	0.0006	0.0092	0.113	900	900	900	0	0	1	-360	360;
	6	11	0.0007	0.0082	0.1389	480	480	480	0	0	1	-360	360;
	6	31	0	0.025	0	1800	1800	1800	1.07	0	1	-360	360;
	7	8	0.0004	0.0046	0.078	900	900	900	0	0	1	-360	360;
	8	9	0.0023	0.0363	0.3804	900	900	900	0	0	1	-360	360;
	9	39	0.001	0.025	1.2	900	900	900	0	0	1	-360	360;
	10	11	0.0004	0.0043	0.0729	600	600	600	0	0	1	-360	360;
	10	13	0.0004	0.0043	0.0729	600	600	600	0	0	1	-360	360;
	10	32	0	0.02	0	900	900	2500	1.07	0	1	-360	360;
	12	11	0.0016	0.0435	0	500	500	500	1.006	0	1	-360	360;
	12	13	0.0016	0.0435	0	500	500	500	1.006	0	1	-360	360;
	13	14	0.0009	0.0101	0.1723	600	600	600	0	0	1	-360	360;
	14	15	0.0018	0.0217	0.366	600	600	600	0	0	1	-360	360;
	15	16	0.0009	0.0094	0.171	600	600	600	0	0	1	-360	360;
	16	17	0.0007	0.0089	0.1342	600	600	600	0	0	1	-360	360;
	16	19	0.0016	0.0195	0.304	600	600	2500	0	0	1	-360	360;
	16	21	0.0008	0.0135	0.2548	600	600	600	0	0	1	-360	360;
	16	24	0.0003	0.0059	0.068	600	600	600	0	0	1	-360	360;
	17	18	0.0007	0.0082	0.1319	600	600	600	0	0	1	-360	360;
	17	27	0.0013	0.0173	0.3216	600	600	600	0	0	1	-360	360;
	19	20	0.0007	0.0138	0	900	900	2500	1.06	0	1	-360	360;
	19	33	0.0007	0.0142	0	900	900	2500	1.07	0	1	-360	360;
	20	34	0.0009	0.018	0	900	900	2500	1.009	0	1	-360	360;
	21	22	0.0008	0.014	0.2565	900	900	900	0	0	1	-360	360;
	22	23	0.0006	0.0096	0.1846	600	600	600	0	0	1	-360	360;
	22	35	0	0.0143	0	900	900	2500	1.025	0	1	-360	360;
	23	24	0.0022	0.035	0.361	600	600	600	0	0	1	-360	360;
	23	36	0.0005	0.0272	0	900	900	2500	1	0	1	-360	360;
	25	26	0.0032	0.0323	0.531	600	600	600	0	0	1	-360	360;
	25	37	0.0006	0.0232	0	900	900	2500	1.025	0	1	-360	360;
	26	27	0.0014	0.0147	0.2396	600	600	600	0	0	1	-360	360;
	26	28	0.0043	0.0474	0.7802	600	600	600	0	0	1	-360	360;
	26	29	0.0057	0.0625	1.029	600	600	600	0	0	1	-360	360;
	28	29	0.0014	0.0151	0.249	600	600	600	0	0	1	-360	360;
	29	38	0.0008	0.0156	0	1200	1200	2500	1.025	0	1	-360	360;
];

%%-----  OPF Data  -----%%
%% generator cost data
%	1	startup	shutdown	n	x1	y1	...	xn	yn
%	2	startup	shutdown	n	c(n-1)	...	c0
mpc.gencost = [
	2	0	0	3	0.077	19.71	1469;
	2	0	0	3	0.009	21.02	2639;
	2	0	0	3	0.009	21.02	2639;
	2	0	0	3	0.030	20.31	1469;
	2	0	0	3	0.077	24.02	2839;
	2	0	0	3	0.009	21.02	2639;
	2	0	0	3	0.009	21.02	2639;
	2	0	0	3	0.030	20.31	1469;
	2	0	0	3	0.077	19.71	1469;
	2	0	0	3	0.077	19.71	1469;
];%33 37 天然气供气
%%
%modification
%故障态有功限制
mpc.branch(:,7)=mpc.branch(:,6)*1.3;
%有功负荷
% mpc.percent = [
%     0.7802	0.7187	0.6791	0.6374	0.6176	0.6176	0.6374	0.6989	0.8	0.8791	0.8989	0.9099	0.8989	0.8791	0.8703	0.8703	0.9099	1	0.989	0.9692	0.9407	0.9187	0.8703	0.8088
% ];
mpc.load = [
    4042.42	3820.2	4496.96	3044.44	2907.07	3391.91	4070.7	4595.95	4876.76	4961.61	5759.59	4977.77	4717.17	4519.19	5301.01	5395.95	5103.03	5406.06	5737.37	5963.63	5521.21	4145.45	5197.97	4927.27
];
%旋转备用取负荷的0.3倍
mpc.spinning = 0.03*mpc.load;
%%
%天然气系统
mpc.GasBranch = [
%index fbus tbus c(k-n)
    1   1   2   0.070;
    2   2   3   0.404;
    3   3   4   0.390;
    4   5   6   0.100;
    5   6   7   0.150;
    6   7   4   0.220;
    7   4   14  0.660;
    8   8   9   0.260;
    9   9   10  0.810;
    10  10  11  0.450;
    11  11  12  0.860;
    12  12  13  0.910;
    13  13  14  0.260;
    14  14  15  0.630;
    15  15  16  0.450;
    16  11  17  0.050;
    17  17  18  0.006;
    18  18  19  0.002;
    19  19  20  0.030;
    ];
mpc.GasBranch(:,4) = mpc.GasBranch(:,4)+0.2;
mpc.GasBus = [
%index PressureMax PressureMin
    1   77.0    0;
    2   77.0    0;
    3   80.0    30.0;
    4   80.0    0;
    5   77.0    0;
    6   80.0    30.0;
    7   80.0    30.0;
    8   66.2    0;
    9   66.2    0;
    10  66.2    30.0;
    11  66.2    0;
    12  66.2    0;
    13  66.2    0;
    14  66.2    0;
    15  66.2    0;
    16  66.2    0;
    17  66.2    0;
    18  80.0    0;
    19  66.2    0;
    20  66.2    25.0;
    ];
mpc.GasSource = [
%index gasbus minW    maxW     cost(美元/Mm3)
    1   1       0.9    1.7391  0.085*1000000;
    2   2       0       1.26    0.085*1000000;
    3   5       0       0.72    0.085*1000000;
    4   8       1.00    2.3018  0.062*1000000;
    5   13      0       0.27    0.062*1000000;
    6   14      0       1.44    0.062*1000000;
];
mpc.GasSource(:,5) = mpc.GasSource(:,5)*5;
mpc.GasGen = [
%gasBus PowerBus
    3   30;
    6   33;
    19  37;
];
%以Mm3为单位
mpc.GasLoad = [
    12.69	10.17	8.35	9.04	12	16.4	15.86	19.49	20.88	21.15	20.27	20.16	19.18	16.66	17.21	18.32	19.71	21.24	23.75	25.42	24.72	23.59	19.68	15.21
]/10+4.18;

%%
%热力系统
mpc.HeatBranch = [
%index fbus tbus FlowWater(kg/s) length(m)  diameter(m)roughness conductivity
    1   1   2   265.85          3500        0.8         0.0005	0.12;
    2   2   3   241.41          1750        0.8         0.0005	0.12;
    3   3   4   143.58          1750        0.8         0.0005	0.12;
    4   2   5   24.44           1750        0.8         0.0005	0.12;
    5   3   6   97.83           1750        0.8         0.0005	0.12;
];
mpc.HeatBranch(:,4) = mpc.HeatBranch(:,4)*3600;%(kg/h)
mpc.HeatBus = [
% index busType %(3=热源，2=负荷，1=不发生热交换的节点) Load    Tsmin   Tsmax   Trmin   Trmax
    1       3                                           0       110     120     60      80;  
    2       1                                           0       110     120     60      80;
    3       1                                           0       110     120     60      80;
    4       2                                           47.2    110     120     60      80;
    5       2                                           8       110     120     60      80;
    6       2                                           32      110     120     60      80;
];
mpc.SituationTempreture = [
    -10 -10 -8.84   -9.42   -9.42   -9.42   -8.84   -8.26   -7.10   -6.52   -5.94   -5.35   -4.77   -4.77   -4.77   -5.35   -5.94   -6.52   -6.52   -6.52   -7.10   -7.68   -8.26   -8.26
];
mpc.CHPgen = [
%HeatBus PowersystemBus
    1       30            24.2    0.31    2.40;
    ];
mpc.EBoiler = [
%bus(Heat)  bus(power system)
    1           24;
];
mpc.HeatLoad = [
    49.95	50	48.14	49.1	49.11	49.13	48.12	47.22	45.19	44.2	43.25	42.26	41.36	41.38	41.41	42.28	43.33	44.24	44.24	44.27	45.26	46.16	47.19	47.2;    
];
end
